<!-- movie-catlog.component.html -->

<div class="container-fluid bg-dark text-white py-4">
  <!-- Header -->
  <header class="row mb-4">
    <div class="col-12">
      <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand text-danger fs-2">Movie Catalog</a>
          <form class="d-flex">
            <input
              class="form-control me-2"
              type="search"
              placeholder="Search movies..."
              (input)="onSearch($event)"
              aria-label="Search"
            >
          </form>
        </div>
      </nav>
    </div>
  </header>

  <!-- Favorites Section -->
  <section class="row mb-4" *ngIf="favoriteMovies.length > 0">
    <div class="col-12">
      <h2 class="mb-3">Your Favorites</h2>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-5 g-4">
        <div class="col" *ngFor="let movie of favoriteMovies">
          <div class="card h-100 bg-dark text-white border-secondary position-relative movie-card">
            <img
              [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path"
              [alt]="movie.title"
              class="card-img-top"
              onerror="this.src='assets/placeholder.jpg'"
            >
            <div class="card-body movie-info">
              <h5 class="card-title">{{ movie.title }}</h5>
              <p class="card-text">{{ movie.overview | slice:0:100 }}...</p>
              <button
                class="btn btn-outline-danger position-absolute top-0 end-0 m-2 rounded-circle favorite-btn"
                (click)="toggleFavorite(movie)"
              >
                <i class="bi bi-heart-fill"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- All Movies Section -->
  <section class="row">
    <div class="col-12">
      <h2 class="mb-3">All Movies</h2>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-5 g-4">
        <div class="col" *ngFor="let movie of movies">
          <div class="card h-100 bg-dark text-white border-secondary position-relative movie-card">
            <img
              [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path"
              [alt]="movie.title"
              class="card-img-top"
              onerror="this.src='assets/placeholder.jpg'"
            >
            <div class="card-body movie-info">
              <h5 class="card-title">{{ movie.title }}</h5>
              <p class="card-text">{{ movie.overview | slice:0:100 }}...</p>
              <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">{{ movie.release_date | date:'yyyy' }}</small>
                <span class="badge bg-warning text-dark">{{ movie.vote_average }}/10</span>
              </div>
              <button
                class="btn btn-outline-danger position-absolute top-0 end-0 m-2 rounded-circle favorite-btn"
                [class.active]="isFavorite(movie.id)"
                (click)="toggleFavorite(movie)"
              >
                <i class="bi" [class.bi-heart]="!isFavorite(movie.id)" [class.bi-heart-fill]="isFavorite(movie.id)"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Load More Button -->
      <div class="text-center mt-4">
        <button
          class="btn btn-danger px-4 py-2"
          (click)="loadMore()"
          *ngIf="!loading"
        >
          Load More
        </button>
        <div class="spinner-border text-danger" role="status" *ngIf="loading">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>
  </section>
</div>
